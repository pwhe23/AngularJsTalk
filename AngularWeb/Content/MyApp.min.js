"use strict";function HomeCtrl(n){n.Name="Alt.net",n.Welcome=function(){alert("Welcome: "+n.Name)}}function HeaderCtrl(n,t){n.location=t}function ErrorHandler(n){alert("Server Error "+ErrorMessage(n.data?n.data:n))}function ErrorMessage(n){return n.InnerException?ErrorMessage(n.InnerException):n.ExceptionMessage||n.Message}function ListCtrl(n,t){n.Refresh=function(){t.List(n.OrderBy,function(t){n.Model=t})},n.$watch("OrderBy",function(){n.Refresh()}),n.OrderBy="Date",n.Delete=function(i){t.Delete(i,function(){n.Refresh()})},n.Where=function(t){n.whereFilter=t==undefined?{}:{Paid:t}},n.Where(),n.Selected=function(t){return n.whereFilter.Paid==t}}function parseISO8601(n){var f=n.split("T"),i=f[0].split("-"),e=f[1].split("Z"),r=e[0].split(":"),u=r[2].split("."),o=Number(r[0]),t=new Date;return t.setUTCFullYear(Number(i[0])),t.setUTCMonth(Number(i[1])-1),t.setUTCDate(Number(i[2])),t.setUTCHours(Number(o)),t.setUTCMinutes(Number(r[1])),t.setUTCSeconds(Number(u[0])),u[1]&&t.setUTCMilliseconds(Number(u[1])),t}function EditCtrl(n,t,i,r){var u=!i.id;n.Model={},u?(n.Model=r.Create(),n.Save=function(){r.Save(n.Model,function(){t.path("/list")})}):(r.Load(i.id,function(t){n.Model=t}),n.Save=function(){r.Update(n.Model,function(){t.path("/list")})}),n.Add=function(){r.CreateItem(n.Model)},n.Remove=function(t){r.RemoveItem(n.Model,t),n.$apply()},n.Total=function(){return r.GetTotal(n.Model)}}var myApp=angular.module("myApp",["ui.directives"]),Db;myApp.config(function(n){n.when("/",{templateUrl:"/Content/home.htm"}).when("/edit",{templateUrl:"/Content/edit.htm"}).when("/edit/:id",{templateUrl:"/Content/edit.htm"}).when("/list",{templateUrl:"/Content/list.htm"}).otherwise({redirectTo:"/"})}),function(n){var t=function(){function t(n){this.$http=n}return t.prototype.List=function(n,t){this.$http.get("/api/orders?$orderby="+n).success(t).error(ErrorHandler)},t.prototype.Delete=function(n,t){this.$http.delete("/api/orders/"+n).success(t).error(ErrorHandler)},t.prototype.Create=function(){var t=new n.Order;return t.Items=[],t},t.prototype.Save=function(n,t){this.$http.post("/api/orders",n).success(t).error(ErrorHandler)},t.prototype.Load=function(n,t){this.$http.get("/api/orders/"+n).success(function(n){n.Date=parseISO8601(n.Date),t(n)}).error(ErrorHandler)},t.prototype.Update=function(n,t){this.$http.put("/api/orders/"+n.OrderId,n).success(t).error(ErrorHandler)},t.prototype.CreateItem=function(t){var i=new n.OrderItem;i.Description="test",i.Amount=0,t.Items.push(i)},t.prototype.RemoveItem=function(n,t){n.Items.splice(t,1)},t.prototype.GetTotal=function(n){return n.Items?n.Items.reduce(function(n,t){return n+t.Amount},0):0},t}();n.Orders=t}(Db||(Db={})),myApp.factory("Orders",function(n){return new Db.Orders(n)}),myApp.filter("checkmark",function(){return function(n){return n?"✓":"✘"}}),myApp.filter("strToDate",function(){return function(n){return parseISO8601(n)}}),myApp.directive("confirm",function(n){return{restrict:"A",link:function(t,i,r){i.bind("click",function(){var i=r.confirmMsg||"Are you sure?",u;return(i.indexOf("{{")>-1&&(i=t.$eval(i)),!confirm(i))?!1:(u=n(r.confirm),u(t),!0)})}}}),myApp.directive("navbar",function(){return{restrict:"E",replace:!0,transclude:!0,template:"<div class='navbar navbar-static-top'><div class='navbar-inner'><div ng-transclude><\/div><\/div>",link:function(){}}}),myApp.config(function(n){n.responseInterceptors.push("httpSpinner");var t=function(n){return $(".ajax-loader").show(),n};n.defaults.transformRequest.push(t)}).factory("httpSpinner",function(n){var t=function(){$(".ajax-loader").hide()};return function(i){return i.then(function(n){return t(),n},function(i){return t(),n.reject(i)})}})